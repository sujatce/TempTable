CREATE OR REPLACE SECURE VIEW ASQN_DEV_ORCHESTRATION_DB.ACCESS.VW_NANPA_AREA_CODE (
	NPA_ID COMMENT 'The NPA or Area Code',
	TYPE_OF_CODE COMMENT 'What type of code is this NPA (Easily Recognizable Code, General Purpose Code)',
	ASSIGNABLE COMMENT 'Is this NPA assignable (Yes/No)',
	EXPLANATION COMMENT 'Is the NPA is not assignable (no in previous field), this is the reason it is not assignable',
	RESERVED COMMENT 'Is the NPA reserved for the relief of another NPA (Yes/No)',
	ASSIGNED COMMENT 'Is the NPA assigned for use (Yes/No)',
	ASSIGNMENT_DT COMMENT 'What date was the assignment made',
	USE COMMENT 'What is the Use of this code (N - nongeograpic; G - Geographic)',
	LOCATION COMMENT 'The geographic location to which the code is assigned (AL, TX, Manitoba, etc.)',
	COUNTRY COMMENT 'The country to which the assignment was made (US, CANADA, BAHAMAS, etc.)',
	IN_SERVICE COMMENT 'Is this NPA in service (Yes/No)',
	IN_SERVICE_DT COMMENT 'What date was this NPA placed in service',
	SERVICE COMMENT 'Special annotation for services accomodated by this NPA',
	STATUS COMMENT ''
    FILE_NAME 'Name of the source file',
    FILE_CREATION_DATE COMMENT 'Creation date of the source file (SYSDATE at load time)',
    UPDATE_DATE COMMENT 'Timestamp recording when the row was last updated'
)COMMENT='The Wellmed Central Quality Reporting team regularly produces member campaign data for stakeholders.  Members should not be contacted at invalid phone numbers.  NANPA is a regulatory body that distributes area codes for north america.  We can filter on area codes to determine which are for business/government/toll free/not in use versus which are reasonably used for individual members.'
AS
SELECT NPA_ID, 
       TYPE_OF_CODE, 
       ASSIGNABLE, 
       EXPLANATION, 
       RESERVED, 
       ASSIGNED, 
       ASSIGNMENT_DT,
       USE, 
       LOCATION, 
       COUNTRY, 
       IN_SERVICE, 
       IN_SERVICE_DT, 
       SERVICE, 
       STATUS,
       FILE_NAME, 
       FILE_CREATION_DATE, 
       UPDATE_DATE 
  FROM ASQN_PRD_ORCHESTRATION_DB.DBO.NANPA_AREA_CODE
  WHERE 
      UPDATE_DATE <= (SELECT MAX_DISPLAY_DATE 
                    FROM ASQN_PRD_CFG_DB.DBO.CFG_VW_CONTROL
                    WHERE VIEW_NAME = 'VW_NANPA_AREA_CODE')
    AND UPDATE_DATE >= (SELECT MIN_DISPLAY_DATE 
                    FROM ASQN_PRD_CFG_DB.DBO.CFG_VW_CONTROL
                    WHERE VIEW_NAME = 'VW_NANPA_AREA_CODE');


CAN YOU TELL ME THIS IS THE ONE I CREATED FORM YOUR INPUTS AND I GOT THE DESCRIPTION FROM PREVIOUS SCHEMA DOCUMENT FOR THE NANPA AREAN TABLE 

PLEASE LE TME KNOW IF THIS IS CORRECT 
