-Command "$zip = Get-ChildItem '\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\CoCodeAssignment_Utilized_AllStates_Public_*.zip' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Expand-Archive -Force $zip.FullName '\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\'"



'"C:\Program Files\7-Zip\7z.exe" x "' 
+ [OUT_FILE] 
+ '" -o"\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\" -y'




-Command "$dir='\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\'; $new='CoCodeAssignment_Utilized_AllStates_Public_' + (Get-Date -Format yyyyMMdd) + '.txt'; $txt=(Get-ChildItem $dir -Filter '*.txt' | Sort-Object LastWriteTime -Descending | Select-Object -First 1).FullName; Rename-Item -Force $txt (Join-Path $dir $new)"


'powershell.exe -noexit  "& ' + 
'Expand-Archive -Path ' + [source] + ' -DestinationPath '+  [destination] + '; exit"' + '
exit'



'powershell.exe -noexit  "& ' + 
'Expand-Archive -Path ' + [source] + ' -DestinationPath '+  [destination] + '; exit"' + '
exit'



%temp%\RunCommand.bat

%temp%\RunCommand.bat



) Text Input fields (same idea)

Create a Text Input with these fields:

Field	Example
source_dir	\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\
destination_dir	\\nasv0618\WM_CQR\N\NANPA_NPA_NXX\Datasources\
base_name	CoCodeAssignment_Utilized_AllStates_Public_

destination_dir can be same as source_dir (rename in place).

âœ… 2) Formula tool: create batch for Rename

Create a new field batch (String) and paste this expression:

'powershell.exe -NoExit "& ' +
'$srcDir=''' + [source_dir] + '''; ' +
'$dstDir=''' + [destination_dir] + '''; ' +
'$base=''' + [base_name] + '''; ' +
'$dt=(Get-Date -Format yyyyMMdd); ' +
'$newName=($base + $dt + ''.txt''); ' +
'$txt=(Get-ChildItem -Path $srcDir -Filter ''*.txt'' | Sort-Object LastWriteTime -Descending | Select-Object -First 1).FullName; ' +
'Rename-Item -Force -Path $txt -NewName (Join-Path $dstDir $newName); exit"'

What it does

Looks in source_dir

Finds the most recently modified .txt

Renames it to:

CoCodeAssignment_Utilized_AllStates_Public_YYYYMMDD.txt
