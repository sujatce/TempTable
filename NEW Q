SELECT DISTINCT
    dm.MEMBER_MBI AS MBI,
    mrm.GMPI_ID,
    mrm.IS_HOSPICE_FLAG,
    mrm.IS_SNP_FLAG,
    mrm.LTI_FLAG
FROM FWRB_PRD_WMIDR_DB.BI_ANALYSIS.MEMBER_REPORT_MONTH AS mrm
JOIN FWRB_PRD_WMIDR_DB.BI_ANALYSIS.DIM_MEMBER AS dm
    ON mrm.GMPI_ID = dm.GMPI_ID
WHERE dm.MEMBER_MBI IS NOT NULL
  AND dm.ACTIVE_FLAG = 1
  AND mrm.ACTIVE_FLAG = 1
  AND mrm.REPORT_MONTH = (
        SELECT MAX(rm.REPORT_MONTH)
        FROM FWRB_PRD_WMIDR_DB.BI_ANALYSIS.MEMBER_REPORT_MONTH AS rm
  )
  AND mrm.MBR_ELIG_INSURANCE_COMPANY_FULL_NAME LIKE '%United%'

UNION ALL

SELECT DISTINCT
    dm.MEMBER_MBI AS MBI,
    mrm.GMPI_ID,
    mrm.IS_HOSPICE_FLAG,
    mrm.IS_SNP_FLAG,
    mrm.LTI_FLAG
FROM FWRB_PRD_WMIDR_DB.BI_ANALYSIS.MEMBER_REPORT_MONTH AS mrm
JOIN FWRB_PRD_WMIDR_DB.BI_ANALYSIS.DIM_MEMBER AS dm
    ON mrm.GMPI_ID = dm.GMPI_ID
WHERE dm.MEMBER_MBI IS NOT NULL
  AND dm.ACTIVE_FLAG = 1
  AND mrm.ACTIVE_FLAG = 1
  AND mrm.REPORT_MONTH = (
        SELECT MAX(rm.REPORT_MONTH)
        FROM FWRB_PRD_WMIDR_DB.BI_ANALYSIS.MEMBER_REPORT_MONTH AS rm
  )
  AND mrm.MBR_ELIG_INSURANCE_COMPANY_FULL_NAME LIKE '%OptumCare%';
