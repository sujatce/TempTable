create or replace secure view
ASQN_DEV_ORCHESTRATION_DB.ACCESS.VW_WM_GRYPHON_LIT_SUPPRESS
    (GRYPHON_LIT_ID COMMENT 'Table Primary Key'
    ,MEMBER_PHONE COMMENT 'Member Phone Number'
    ,MBI COMMENT 'Member Beneficiary Identifier issued by CMS to identify Medicare beneficiaries'
    ,GMPI_ID COMMENT 'WellMed unique member identifier'
    ,MEMBER_LAST_NAME COMMENT 'Last name of the member enrolled in the health plan'
    ,MEMBER_FIRST_NAME COMMENT 'First name of the member enrolled in the health plan'
    ,MEMBER_DATE_OF_BIRTH COMMENT 'Date of birth of the member enrolled in the health plan'
    ,FILE_CREATION_DATE COMMENT 'Date file was sent to vendor Gryphon for evaluation'
    ,UPDATE_DATE COMMENT 'Timestamp recording when the row was last updated'
    ) 
    COMMENT = 'This view provides a list of South Region members to suppress for being known legal litigators. \n\nWellMed Central Quality Performance Analytics connects to external data provider Gryphon to pull South Region members with a known history of litigation. This data set is the SOURCE OF TRUTH for South Region Gryphon Legal Litigator suppressions. \n\nThe Litigator List is a database of telephone numbers and other related data parameters associated with professional plaintiffs that have been pulled from court filings and associated with legal action surrounding alleged TCPA, FDCPA, FCRA, CFPB, Do Not Contact and other telemarketing-type violations. This is not a government created/mandated list. It is a dataset supported by WebRecon. Gryphon refreshes the Litigator List data twice a month, on the 1st and 15th.  WellMed contracts with Gryphon to access this data, and refreshes the South Region data set on the 18th of each month.\n\n***NOTE:*** WHEN USING LEGAL LITIGATOR DATA IT IS APPROPRIATE TO JOIN ON *EITHER* A MEMBER IDENTIFIER (GMPI or MBI) *OR* TELEPHONE NUMBER TO REDUCE RISK OF CALLING A KNOWN LITIGATOR.'
AS
SELECT DISTINCT
     GRYPHON_LIT_ID
    ,MEMBER_PHONE
    ,MBI
    ,GMPI_ID
    ,MEMBER_LAST_NAME
    ,MEMBER_FIRST_NAME
    ,MEMBER_DATE_OF_BIRTH
    ,FILE_CREATION_DATE
    ,UPDATE_DATE
FROM ASQN_DEV_ORCHESTRATION_DB.DBO.GRYPHON_LIT_CLEANSED
WHERE LITIGATOR_LIST IN ('TRUE','1')
AND UPDATE_DATE <= (SELECT MAX_DISPLAY_DATE 
                    FROM ASQN_DEV_CFG_DB.DBO.CFG_VW_CONTROL
                    WHERE VIEW_NAME = 'VW_WM_GRYPHON_LIT_SUPPRESS')
AND UPDATE_DATE >= (SELECT MIN_DISPLAY_DATE 
                    FROM ASQN_DEV_CFG_DB.DBO.CFG_VW_CONTROL
                    WHERE VIEW_NAME = 'VW_WM_GRYPHON_LIT_SUPPRESS');
