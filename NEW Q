-- 1. Create sequence for surrogate key
CREATE OR REPLACE SEQUENCE ASQN_DEV_ORCHESTRATION_DB.DBO.SMS_RESPONSE_SEQ
    START WITH 1
    INCREMENT BY 1 order
    COMMENT = 'Sequence used to generate unique identifiers for SMS_RESPONSE.SMS_RESPONSE_ID';

-- 2. Create table with inline column comments
CREATE OR REPLACE TABLE ASQN_DEV_ORCHESTRATION_DB.DBO.SMS_RESPONSE (

    SMS_RESPONSE_ID NUMBER(38,0) NOT NULL
        DEFAULT ASQN_DEV_ORCHESTRATION_DB.DBO.SMS_RESPONSE_SEQ.NEXTVAL
        COMMENT 'System-generated unique identifier for each SMS delivery record, populated using a Snowflake Sequence',

    CAMPAIGN_TARGET_ID NUMBER(38,0)
        COMMENT 'Foreign key used to link SMS Delivered records to CAMPAIGN_TARGET (reserved for future use)',

    GMPI_ID NUMBER(38,0)
        NOT NULL
        COMMENT 'WellMed unique member identifier',

    MBI VARCHAR(20)
        COMMENT 'Member Beneficiary Identifier issued by CMS to identify Medicare beneficiaries',

    PHONE_ID NUMBER(38,0)
        NOT NULL
        COMMENT 'Unique identifier assigned by the SMS Manager system to represent a specific phone number associated with a member',

    TEMPLATE_ID NUMBER(38,0)
        NOT NULL
        COMMENT 'Business-defined identifier representing the SMS message template approved for campaign communications',

    PROGRAM_ID NUMBER(38,0)
        NOT NULL
        COMMENT 'Business-defined identifier representing an SMS program under which the message was sent',

    PROGRAM_NAME VARCHAR(255)
        NOT NULL
        COMMENT 'Name of the campaign program',

    MEMBER_LAST_NAME VARCHAR(60)
        NOT NULL
        COMMENT 'Last name of the member enrolled in the health plan',

    MEMBER_FIRST_NAME VARCHAR(50)
        NOT NULL
        COMMENT 'First name of the member enrolled in the health plan',

    MEMBER_BIRTH_DATE DATE
        COMMENT 'Date of birth of the member enrolled in the health plan',

    MEMBER_PHONE VARCHAR(15)
        NOT NULL
        COMMENT 'Mobile phone number of the member',

    OPTUM_SMS_MANAGER_STATUS VARCHAR(50)  NOT NULL
        COMMENT 'SMS Manager internal processing status indicating whether the outbound message request was accepted or failed at the API layer',

    CARRIER_RESPONSE_STATUS VARCHAR(50)  NOT NULL
        COMMENT 'Delivery status returned by the SMS provider/carrier (DELIVERED, FAILED, QUEUED_ON_CHANNEL)',

    SOURCE VARCHAR(75)
        COMMENT 'Source through which the message was triggered; represents an outbound SMS sent from the system to a recipient',

    CAMPAIGN_START_DATE DATE
        COMMENT 'Start date of the campaign, if known',

    CAMPAIGN_MONTH DATE
        COMMENT 'Business month in which the SMS campaign was executed',

    SMS_CREATED_DATE TIMESTAMP_NTZ(7) NOT NULL
        COMMENT 'Timestamp when the outbound message record was created in the SMS Manager system',

    SMS_DELIVER_DATE TIMESTAMP_NTZ(7) NOT NULL
        COMMENT 'Timestamp when the message was scheduled or released for delivery',

    SMS_EXPIRE_DATE TIMESTAMP_NTZ(7) NOT NULL
        COMMENT 'Timestamp after which the message should no longer be delivered',

    SMS_UPDATED_DATE TIMESTAMP_NTZ(7) NOT NULL
        COMMENT 'Timestamp when the SMS message record was last updated in the SMS Manager system',

    CONTRACT_ID VARCHAR(50)
        COMMENT 'Unique identifier assigned to a specific contract',

    CONTRACT_PBP VARCHAR(50)
        COMMENT 'Benefit Plan or Plan code specifying benefits included under the contract',

    MBR_ELIG_INSURANCE_COMPANY VARCHAR(50)
        COMMENT 'Member insurance company',

    FILE_NAME VARCHAR(250)
        NOT NULL
        COMMENT 'Name of the source file associated with the record',

    FILE_CREATION_DATE DATE
        NOT NULL
        COMMENT 'Date the source file was created',

    USER_STORY VARCHAR(25)
        COMMENT 'User story ID associated with data ingestion or update',

    INSERT_DATE TIMESTAMP_NTZ(7)
        NOT NULL DEFAULT CAST(CONVERT_TIMEZONE('America/Chicago', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_TZ(9))) AS TIMESTAMP_NTZ(7))
        COMMENT 'Timestamp when the row was first inserted into the table',

    INSERT_USER VARCHAR(75)
        NOT NULL
        COMMENT 'User or system that inserted the row',

    UPDATE_DATE TIMESTAMP_NTZ(7)
        NOT NULL   DEFAULT CAST(CONVERT_TIMEZONE('America/Chicago', CAST(CURRENT_TIMESTAMP() AS TIMESTAMP_TZ(9))) AS TIMESTAMP_NTZ(7))
        COMMENT 'Timestamp when the row was last updated',

    UPDATE_USER VARCHAR(75)
        NOT NULL
        COMMENT 'User or system that last updated the row',
        
    CONSTRAINT PK_SMS_RESPONSE_PRIMARYKEY PRIMARY KEY (SMS_RESPONSE_ID)

)
COMMENT = 'The Wellmed Central Quality Reporting team tracks outbound SMS message delivery for UHC membership campaign SMS outreach program. SMS messages are sent to eligible members based on consent preferences and campaign criteria. Delivery and processing details for each outbound SMS message are captured and stored in the SMS_RESPONSE table.';
