SELECT MEMBER_MBI,
       GMPI_ID,
       ACTIVE_FLAG,
       INSERT_DATE,
       UPDATE_DATE
FROM DIM_MEMBER
WHERE MEMBER_MBI IN (
    SELECT MEMBER_MBI
    FROM DIM_MEMBER
    GROUP BY MEMBER_MBI
    HAVING COUNT(*) > 1
)
ORDER BY MEMBER_MBI, GMPI_ID;




SELECT 
    MEMBER_MBI,
    STRING_AGG(CAST(GMPI_ID AS NVARCHAR(50)), ', ') WITHIN GROUP (ORDER BY GMPI_ID) AS All_GMPI
FROM DIM_MEMBER
GROUP BY MEMBER_MBI
HAVING COUNT(*) > 1
ORDER BY MEMBER_MBI;
